<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Proposer un trajet – JaalibaDaily</title>
  <link rel="stylesheet" href="assets/css/style.css">
</head>

<body>

<header>
  <nav class="nav">
    <div class="logo">
      <div class="logo-icon">JD</div>
      <span>JaalibaDaily</span>
    </div>

    <div class="nav-cta">
      <a href="index.html" class="btn btn-outline">Accueil</a>
      <a href="profil.html" class="btn btn-primary">Mon profil</a>
    </div>
  </nav>
</header>

<div class="container-small">
  <h2 class="center">Proposer un trajet</h2>

  <form id="tripForm" class="form-card">

    <div>
      <label>Départ</label>
      <input id="from" type="text" placeholder="Matoto, Cosa, Kipé..." required>
    </div>

    <div>
      <label>Arrivée</label>
      <input id="to" type="text" placeholder="Kaloum, Lambanyi, Sonfonia..." required>
    </div>

    <div>
      <label>Date</label>
      <input id="date" type="date" required>
    </div>

    <div>
      <label>Places disponibles</label>
      <input id="seats" type="number" min="1" max="6" required>
    </div>

    <div>
      <label>Prix (GNF)</label>
      <input id="price" type="number" min="1000" required>
    </div>

    <button class="btn btn-primary" type="submit">Publier le trajet</button>

  </form>
</div>

<script>
// Vérifier si l'utilisateur est connecté
let currentUser = JSON.parse(localStorage.getItem("currentUser"));
if (!currentUser) {
  window.location.href = "connexion.html";
}

document.getElementById("tripForm").addEventListener("submit", function(e) {
  e.preventDefault();

  const from = document.getElementById("from").value.trim();
  const to = document.getElementById("to").value.trim();
  const date = document.getElementById("date").value;
  const seats = document.getElementById("seats").value;
  const price = document.getElementById("price").value;

  if (!from || !to || !date || !seats || !price) {
    alert("Veuillez remplir tous les champs.");
    return;
  }

  let trips = JSON.parse(localStorage.getItem("trips")) || [];

  const newTrip = {
    id: Date.now(),
    owner: currentUser.email,
    from,
    to,
    date,
    seats,
    price
  };

  trips.push(newTrip);
  localStorage.setItem("trips", JSON.stringify(trips));

  alert("Trajet publié avec succès !");
  window.location.href = "profil.html";
});
</script>
<script>
// HEADER DYNAMIQUE
document.addEventListener("DOMContentLoaded", () => {
    const header = document.querySelector(".nav-cta");

    const currentUser = JSON.parse(localStorage.getItem("currentUser"));

    if (!header) return;

    if (!currentUser) {
        // NON CONNECTÉ
        header.innerHTML = `
            <a href="connexion.html" class="btn btn-outline">Connexion</a>
            <a href="inscription.html" class="btn btn-primary">Créer un compte</a>
        `;
    } else {
        // CONNECTÉ
        header.innerHTML = `
            <a href="index.html" class="btn btn-outline">Accueil</a>
            <a href="recherche.html" class="btn btn-primary">Rechercher</a>
            <a href="proposer.html" class="btn btn-outline">Proposer</a>
            <a href="mes-reservations.html" class="btn btn-outline">Mes réservations</a>
            <a href="profil.html" class="btn btn-primary">Profil</a>
            <button id="logoutBtn" class="btn btn-outline">Se déconnecter</button>
        `;
    }

    // Bouton déconnexion
    const logoutBtn = document.getElementById("logoutBtn");
    if (logoutBtn) {
        logoutBtn.addEventListener("click", () => {
            localStorage.removeItem("currentUser");
            alert("Déconnexion réussie");
            window.location.href = "index.html";
        });
    }
});
</script>

</body>
</html>
